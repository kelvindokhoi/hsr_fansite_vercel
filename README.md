# Honkai: Star Rail Fan Site â€” Cloud / Production Deployment

This repository represents the **production, cloud-deployed evolution** of the Honkai: Star Rail Fan Site. It builds upon the original local full-stack implementation and documents the process of migrating the project to a **free-tier, cloud-based architecture**.

> ğŸ“Œ **Original (Local MySQL + MAMP) Project:**
> [https://github.com/kelvindokhoi/hsr_fansite](https://github.com/kelvindokhoi/hsr_fansite)

This README is intentionally written as a **deployment story**, explaining not just *what* to do, but *why* certain architectural decisions were made.

---

## ğŸŒ Live Architecture Overview

The live version of this project is deployed using the following stack:

* **Vercel** â€” Frontend hosting (React + Vite)
* **Oracle Cloud Infrastructure (OCI)** â€” PHP backend hosting
* **Supabase (PostgreSQL)** â€” Cloud-hosted production database

Compared to the original project:

* **MySQL â†’ PostgreSQL**
* **Local MAMP â†’ Oracle Cloud VM**
* Minor **PHP and JavaScript adjustments** were required due to structural and SQL differences

---

## ğŸ“ Repository Purpose

This repository:

* Contains **production-ready code**
* Demonstrates how to deploy a full-stack application using **only free-tier services**
* Complements the original repository by showing how the project scales from local development to cloud production

The original repository focuses on **local setup and development**. This one focuses on **deployment and infrastructure**.

---

## ğŸ–¥ï¸ Oracle Cloud Backend Setup (PHP)

### 1ï¸âƒ£ Create Oracle Cloud Infrastructure Resources

1. Create a **VCN (Virtual Cloud Network)**
2. Create a **public subnet** inside the VCN
3. Launch a **Compute Instance (Ubuntu)** and assign it a **public IPv4 address**

> A public IP is required so the PHP backend can be accessed by the Vercel frontend.

---

### 2ï¸âƒ£ Upload Backend Files to Oracle VM

The PHP backend for the cloud version lives in:

```
hsrapp_oracle_to_supabase/
```

Upload this folder to the **Oracle VM home directory** (`~`).

I personally used **WSL2 (Ubuntu 24)** to SCP the files to the server, but **this is not a requirement** â€” any SSH-capable environment works.

---

### 3ï¸âƒ£ Upload Static Images

Static image assets must be placed in:

```
/var/www/html/public/images/
```

This directory is used by the PHP backend and referenced by the frontend for character and UI assets.

---

### 4ï¸âƒ£ Open Required Network Ports

To allow HTTP/HTTPS traffic, configure the VM firewall:

```bash
sudo iptables -I INPUT -p tcp --dport 80 -j ACCEPT
sudo iptables -I INPUT -p tcp --dport 443 -j ACCEPT
sudo netfilter-persistent save
```

Ensure DNS resolution works correctly:

```bash
echo "nameserver 8.8.8.8" | sudo tee /etc/resolv.conf
```

> These steps ensure the backend is reachable from the public internet.

---

## âš™ï¸ Vercel Frontend Configuration

### Environment Variables

The following environment variables must be configured in **Vercel**:

```env
IMAGE_UPLOAD_PATH=/var/www/html/public/images/
VITE_IMAGE_BASE_URL=
```

* `IMAGE_UPLOAD_PATH` tells the backend where to store image uploads
* `VITE_IMAGE_BASE_URL` is intentionally left empty to allow flexible asset resolution

---

## ğŸ—„ï¸ Supabase (PostgreSQL) Database Setup

Supabase replaces the local MySQL database used in development.

### Schema Definition

```sql
CREATE TABLE public.characters (
  id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name TEXT UNIQUE NOT NULL,
  rarity INT NOT NULL CHECK (rarity IN (4, 5)),
  element TEXT NOT NULL CHECK (element IN ('Lightning', 'Wind', 'Quantum', 'Physical', 'Fire', 'Imaginary', 'Ice')),
  path TEXT NOT NULL CHECK (path IN ('Nihility', 'Remembrance', 'Erudition', 'Hunt', 'Destruction', 'Harmony', 'Preservation', 'Abundance', 'Elation'))
);

CREATE TABLE roles (
  id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  role_name TEXT NOT NULL UNIQUE
);

CREATE TABLE users (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  username TEXT NOT NULL UNIQUE,
  password_hash TEXT NOT NULL,
  created_at TIMESTAMP DEFAULT now() NOT NULL,
  stellar_jade_balance BIGINT NOT NULL DEFAULT 0,
  role_id INT REFERENCES public.roles(id)
);

INSERT INTO public.roles (role_name) VALUES
('admin'),
('user');
```

> Passwords are stored as hashes and authentication logic mirrors the original project with PostgreSQL-compatible queries.

---

## ğŸ” Project Relationship

* This repository documents **how the live version was deployed**
* The original repository documents **how the project was built locally**
* Both READMEs intentionally **reference each other** to show the full lifecycle of the application

Together, they tell the story of:

> Local Development â†’ Cloud Migration â†’ Production Deployment

---

## ğŸ§  Final Notes

* No secrets are committed to this repository
* Environment variables are used for all sensitive configuration
* The architecture is designed to be reproducible using **free-tier services only**

---

Made with â¤ï¸ by Kelvin
